@* recycling.Web.UI/Views/Staff/Login.cshtml *@
@model recycling.Model.StaffLoginViewModel

@{
    ViewBag.Title = "工作人员登录";
}

<div class="login-container">
    <h2 class="login-title">工作人员登录</h2>

    @using (Html.BeginForm("Login", "Staff", FormMethod.Post, new { @class = "login-form active" }))
    {
        @Html.AntiForgeryToken()

        if (ModelState.IsValid == false)
        {
            <div class="validation-summary-errors">
                @Html.ValidationSummary(true, "", new { @class = "text-danger" })
            </div>
        }

        <!-- 角色选择区域 - 仅工作人员登录有此部分 -->
        <div class="role-selection">
            <label class="control-label">@Html.DisplayNameFor(model => model.StaffRole)</label>
            <div class="role-options">
                <label class="role-option">
                    @Html.RadioButtonFor(model => model.StaffRole, "recycler", new { @checked = "checked" }) 回收员
                </label>
                <label class="role-option">
                    @Html.RadioButtonFor(model => model.StaffRole, "admin") 管理员
                </label>
                <label class="role-option">
                    @Html.RadioButtonFor(model => model.StaffRole, "superadmin") 超级管理员
                </label>
            </div>
            @Html.ValidationMessageFor(model => model.StaffRole, "", new { @class = "text-danger" })
        </div>

        <!-- 用户名输入框（与用户登录一致） -->
        <div class="form-group">
            @Html.LabelFor(model => model.Username, new { @class = "control-label" })
            @Html.TextBoxFor(model => model.Username, new { @class = "form-control", @placeholder = "请输入用户名" })
            @Html.ValidationMessageFor(model => model.Username, "", new { @class = "text-danger" })
        </div>

        <!-- 密码输入框（带小眼睛，与用户登录一致） -->
        <div class="form-group password-group">
            @Html.LabelFor(model => model.Password, new { @class = "control-label" })
            <div class="password-input-container">
                @Html.PasswordFor(model => model.Password, new { @class = "form-control password-input", @placeholder = "请输入密码" })
                <button type="button" class="toggle-password" aria-label="显示/隐藏密码">
                    <span class="glyphicon glyphicon-eye-open"></span>
                </button>
            </div>
            @Html.ValidationMessageFor(model => model.Password, "", new { @class = "text-danger" })
        </div>

        <!-- 验证码（与用户登录一致） -->
        <div class="form-group">
            @Html.LabelFor(model => model.Captcha, new { @class = "control-label" })
            <div class="captcha-container">
                @Html.TextBoxFor(model => model.Captcha, new { @class = "form-control captcha-input", @placeholder = "请输入验证码" })
                <div class="captcha-image" id="captchaImage">
                    @Model.GeneratedCaptcha
                </div>
            </div>
            @Html.ValidationMessageFor(model => model.Captcha, "", new { @class = "text-danger" })
            @Html.HiddenFor(model => model.GeneratedCaptcha)
        </div>

        <!-- 登录按钮（与用户登录一致） -->
        <div class="login-buttons">
            <input type="submit" value="登录" class="btn btn-login" />
            <input type="reset" value="取消" class="btn btn-cancel" />
        </div>
    }
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script>
        // 验证码刷新功能（与用户登录一致）
        $('#captchaImage').click(function () {
            $.get('@Url.Action("Login", "Staff")', function (data) {
                var newCaptcha = $(data).find('#GeneratedCaptcha').val();
                $('#captchaImage').text(newCaptcha);
                $('#GeneratedCaptcha').val(newCaptcha);
                $('#Captcha').val('');
            });
        });

        // 密码显示/隐藏功能（与用户登录一致）
        $('.toggle-password').click(function () {
            var passwordInput = $(this).closest('.password-input-container').find('input');
            var type = passwordInput.attr('type') === 'password' ? 'text' : 'password';
            passwordInput.attr('type', type);

            // 切换图标
            var icon = $(this).find('span');
            if (type === 'password') {
                icon.removeClass('glyphicon-eye-close').addClass('glyphicon-eye-open');
            } else {
                icon.removeClass('glyphicon-eye-open').addClass('glyphicon-eye-close');
            }
        });
    </script>
}